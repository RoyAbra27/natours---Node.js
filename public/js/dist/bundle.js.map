{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/mapElement.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable*/\r\n// import 'core-js/stable';\r\nimport { login, logout } from './login.js';\r\nimport { displayMap } from './mapElement.js';\r\nimport { updateData } from './updateSettings.js';\r\nimport { bookTour } from './stripe.js';\r\n\r\nconst mapDisplay = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\nif (mapDisplay) {\r\n  const locations = JSON.parse(mapDisplay.dataset.locations);\r\n  displayMap(locations);\r\n}\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logOutBtn) {\r\n  logOutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n\r\n    updateData(form, 'profile');\r\n  });\r\n}\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n\r\n    await updateData(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password'\r\n    );\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n","// import axios from 'axios';\r\n\r\n/* eslint-disable*/\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1000);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n    if ((res.status = 'success')) location.reload(true);\r\n  } catch (error) {\r\n    // console.log(error);\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n","// success / error\r\n/*eslint-disable*/\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n","/* eslint-disable*/\r\n\r\nexport const displayMap = (locations) => {\r\n  var map = tt.map({\r\n    key: 'aswuJFdV8UlNpye0AEuR9AA81M8gCZ8R',\r\n    container: 'map',\r\n    style:\r\n      'https://api.tomtom.com/style/1/style/21.1.0-*/?map=basic_main-lite&poi=poi_main',\r\n    scrollZoom: false,\r\n  });\r\n\r\n  const bounds = new tt.LngLatBounds();\r\n\r\n  locations.forEach((location) => {\r\n    const newMarker = document.createElement('div');\r\n    newMarker.className = 'marker';\r\n\r\n    new tt.Marker({\r\n      element: newMarker,\r\n    })\r\n      .setLngLat(location.coordinates)\r\n      .addTo(map);\r\n\r\n    new tt.Popup({\r\n      offset: 30,\r\n    })\r\n      .setLngLat(location.coordinates)\r\n      .setHTML(`<p>Day ${location.day}: ${location.description}</p>`)\r\n      .addTo(map);\r\n\r\n    bounds.extend(location.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: { top: 250, bottom: 150, left: 50, right: 50 },\r\n  });\r\n};\r\n","/* eslint-disable*/\r\nimport { showAlert } from './alerts';\r\n\r\n// type is profile/password\r\nexport const updateData = async (data, type) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url: `/api/v1/users/update-my-${type}`,\r\n      data,\r\n    });\r\n    if (res.data.status === 'success') {\r\n      showAlert(\r\n        'success',\r\n        `${type[0].toUpperCase() + type.slice(1)} updated successfully!`\r\n      );\r\n      location.reload(true);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n","/*eslint-disable */\r\nimport { showAlert } from './alerts';\r\n\r\nconst stripe = Stripe(\r\n  'pk_test_51Mt761BIY599TDnaGhOcLDYa0yALsq91eFBWyyC9NpccPLllCBCxdLyAhjzm5Cr0zIexc7cSJEpEXegleGXSxSCX00u8Ml1xPm'\r\n);\r\nexport const bookTour = async (tourId) => {\r\n  try {\r\n    const session = await axios(`/api/v1/booking/checkout-session/${tourId}`);\r\n    location.assign(session.data.url);\r\n  } catch (error) {\r\n    // console.log(error.response.data);\r\n    showAlert('error', error);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../../"}